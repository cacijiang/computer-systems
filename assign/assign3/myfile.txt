deep
learning-based
methods
for
predicting
spatial-temporal
data
such
as
crowd
flows
need
to
consider
both
spatial
dependency
and
temporal
dependency
previous
research
mainly
focused
on
modeling
spatial
dependency
whereas
studies
on
temporal
dependency
are
few
existing
finite
deep
learning-based
methods
for
temporal
dependency
modeling
can
be
divided
into
rnn-based
methods
and
domain
knowledge-based
methods
however
rnn-based
methods
are
hard
to
learn
very
longterm
temporal
dependency
and
domain
knowledge-based
methods
cannot
model
temporal
dependency
automatically
depending
on
data
pre-processing
based
on
prior
knowledge
in
view
of
the
problem
crowd
flows
prediction
in
regular
gridded
regions
are
studied
and
a
model
called
pre-trained
bidirectional
temporal
representation
(pbtr)
based
on
transformer
encoder
is
proposed
capable
of
modeling
very
long-term
temporal
dependency
automatically
pbtr
is
simple
scalable
and
can
be
combined
with
any
other
spatial
component
furthermore
we
introduce
crowd
flows
prediction
based
on
pbtr
(cppbtr)
to
form
a
transformer
based
encoder-decoder
framework
there
are
two
decode
stages
in
the
proposed
model
at
decoder-stage
1
’draft’
sequence
is
generated
at
decoder-stage
2
each
timestep
of
the
‘draft’
sequence
is
masked
and
fed
into
pbtr
to
predict
the
refined
flow
for
each
masked
position
experiment
results
demonstrate
that
our
method
outperforms
rnn-based
methods
and
domain
knowledge-based
methods
in
this
paper
crowd
flows
prediction
in
regular
gridded
regions
is
studied
[1]
[2]
[7]
traffic
flow
predicting
is
a
very
important
component
of
urban
computing
however
it
is
a
very
challenging
task
affected
by
a
complex
of
factors:
spatial
dependencies
(or
spatial
representation)
temporal
dependencies
(or
temporal
representation)
and
external
influences
(weather
conditions
events
and
so
on)
deep
learning
has
been
successful
in
many
fields
[19]
recently
many
researchers
have
tried
to
use
neural
networks
for
many
types
of
traffic
flow
prediction
including
taxi
demand
prediction
[6]
crowd
flows
prediction
[1]
[2]
[7]
speed
prediction
[8]
and
so
on
[20]
crowd
flow
is
a
typical
spatial-temporal
data
researchers
have
considered
temporal
and
spatial
properties
of
crowd
flows
when
applying
deep
neural
networks
(dnns)
in
order
to
model
the
spatial
dependency
of
crowd
flows
a
popular
way
is
to
treat
the
flow
data
at
each
timestep
as
an
image
and
utilize
convolutional
neural
network
(cnns)
to
model
spatial
correlation
[1]

[2]

[21]
however
not
all
traffic
data
can
be
represented
by
images
with
time
series
with
the
rise
of
graph
neural
networks
an
increasing
number
of
researchers
uses
graphs
to
describe
traffic
data
and
applies
graph
neural
networks
(gnns)
to
learn
spatial
representation
in
terms
of
modeling
temporal
dependency
it
remains
very
challenging
because
there
are
multiple
types
of
temporal
dependencies
in
this
paper
we
proposed
a
general
framework
called
pbtr
(pre-trained
bidirectional
temporal
representation)
to
learn
the
temporal
dependency
of
spatial-temporal
data
we
also
proposed
a
sequence
to
sequence
framework
to
predict
crowd
flows
in
regular
region
based
on
transformer
including
pbtr
as
the
encoder
experiment
results
demonstrate
that
pbtr
is
capable
of
modeling
very
long-term
temporal
dependency
and
cppbtr
outperforms
all
baselines
in
the
future
we
plan
to
combine
our
method
with
graph
neural
networks
(gnn)
applying
pbtr
on
spatial-temporal
graphs
such
as
crowd
flows
in
irregular
regions
vehicle
speed
prediction
on
road
route
